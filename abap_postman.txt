METHOD send_request.
    " Declarations
    DATA: lo_client      TYPE REF TO if_http_client,
          lv_status      TYPE i,
          lv_status_text TYPE string,
          lx_root        TYPE REF TO cx_root,
          lv_err         TYPE string,
          lv_dest        TYPE c LENGTH 20 VALUE 'CPI_MM16_ENVIA_TORRA',
          lv_json        TYPE string,
          lv_json_x      TYPE xstring,
          lv_len         TYPE string.

    " Create HTTP Object
    cl_http_client=>create_by_destination(
      EXPORTING
        destination                = lv_dest                 " Logical destination (specified in function call)
      IMPORTING
        client                     = lo_client                " HTTP Client Abstraction
      EXCEPTIONS
        argument_not_found         = 1                " Connection parameter (destination) not available
        destination_not_found      = 2                " Destination was not found
        destination_no_authority   = 3                " No Authorization to Use HTTP Destination
        plugin_not_active          = 4                " HTTP/HTTPS communication not available
        internal_error             = 5                " Internal error (e.g. name too long)      " Error accessing secure store administration
        OTHERS                     = 6 ).

    IF sy-subrc <> 0.
      lo_client->close( ).
    ENDIF.

    IF lo_client IS BOUND.
      lo_client->request->set_method( if_http_request=>co_request_method_post ).
    ENDIF.

    " Headers
    lo_client->request->set_header_field(
      name  = 'Content-Type'
      value = 'application/json; charset=utf-8'
    ).

    lo_client->request->set_header_field(
      name  = 'Accept'
      value = 'application/json'
    ).

    " Body (JSON)
    lv_json = prepare_payload( ).
    lv_json_x = cl_abap_codepage=>convert_to( source = lv_json ).
    lo_client->request->set_data( lv_json_x ).

    " Auth
    lo_client->authenticate(
      username = 'matheus.gabriel@prestativ.com.br'
      password = '@@Brasil01' ).

    " Sending the request
    lo_client->send(
      EXPORTING
        timeout                    = if_http_client=>co_timeout_default " Timeout of Answer Waiting Time
      EXCEPTIONS
        http_communication_failure = 1                  " Communication Error
        http_invalid_state         = 2                  " Invalid state
        http_processing_failed     = 3                  " Error when processing method
        http_invalid_timeout       = 4                  " Invalid Time Entry
        OTHERS                     = 5
    ).

    " Receiving the response
    lo_client->receive(
          EXCEPTIONS
            http_communication_failure = 1                " Communication Error
            http_invalid_state         = 2                " Invalid state
            http_processing_failed     = 3                " Error when processing method
            OTHERS                     = 4
    ).

    lo_client->response->get_status(
      IMPORTING
        code   = lv_status                 " HTTP Status Code
        reason = lv_status_text            " HTTP status description
    ).

    " Writing the response
    DATA(lv_result) = lo_client->response->get_cdata( ).
    WRITE: / lv_status, ' ', lv_status_text.
    WRITE: / 'Response:'.
    WRITE: / lv_result.

    " Closing the request
    lo_client->close( ).

  ENDMETHOD.